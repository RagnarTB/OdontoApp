<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    th:replace="~{layout/base :: layout(titulo='Historial Clínico', contenido=~{::#contenido-principal})}">

<body>
    <div id="contenido-principal">
        <section class="content-header">
            <div class="container-fluid">
                <div class="row mb-2">
                    <div class="col-sm-6">
                        <h1><i class="fas fa-notes-medical mr-2"></i>Historial Clínico</h1>
                        <p class="text-muted" th:text="${paciente.nombreCompleto}"></p>
                    </div>
                    <div class="col-sm-6">
                        <a th:href="@{/pacientes}" class="btn btn-outline-secondary float-sm-right">
                            <i class="fas fa-arrow-left mr-2"></i> Volver al Listado
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="content">
            <div class="container-fluid">
                <!-- Información del Paciente -->
                <div class="row">
                    <div class="col-md-3">
                        <div class="card card-primary card-outline">
                            <div class="card-body box-profile">
                                <div class="text-center">
                                    <div class="user-avatar bg-primary mx-auto" style="width: 100px; height: 100px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; color: white; font-weight: bold;">
                                        <span th:text="${#strings.substring(paciente.nombreCompleto, 0, 1)}"></span>
                                    </div>
                                </div>

                                <h3 class="profile-username text-center mt-3" th:text="${paciente.nombreCompleto}"></h3>

                                <ul class="list-group list-group-unbordered mb-3">
                                    <li class="list-group-item">
                                        <b><i class="fas fa-id-card mr-2"></i>Documento</b>
                                        <span class="float-right" th:text="${paciente.tipoDocumento.codigo + ' ' + paciente.numeroDocumento}"></span>
                                    </li>
                                    <li class="list-group-item">
                                        <b><i class="fas fa-envelope mr-2"></i>Email</b>
                                        <span class="float-right" th:text="${paciente.email}"></span>
                                    </li>
                                    <li class="list-group-item">
                                        <b><i class="fas fa-phone mr-2"></i>Teléfono</b>
                                        <span class="float-right" th:text="${paciente.telefono ?: '-'}"></span>
                                    </li>
                                    <li class="list-group-item">
                                        <b><i class="fas fa-birthday-cake mr-2"></i>Nacimiento</b>
                                        <span class="float-right" th:if="${paciente.fechaNacimiento}"
                                              th:text="${#temporals.format(paciente.fechaNacimiento, 'dd/MM/yyyy')}"></span>
                                        <span class="float-right text-muted" th:unless="${paciente.fechaNacimiento}">-</span>
                                    </li>
                                    <li class="list-group-item">
                                        <b><i class="fas fa-map-marker-alt mr-2"></i>Dirección</b>
                                        <div class="mt-1 text-muted small" th:text="${paciente.direccion ?: 'No especificada'}"></div>
                                    </li>
                                </ul>

                                <a th:href="@{/pacientes/editar/{id}(id=${paciente.id})}"
                                   class="btn btn-primary btn-block"
                                   sec:authorize="hasAuthority('EDITAR_PACIENTES')">
                                    <i class="fas fa-edit mr-2"></i><b>Editar Datos</b>
                                </a>
                            </div>
                        </div>

                        <!-- Alergias y Antecedentes -->
                        <div class="card card-warning card-outline">
                            <div class="card-header">
                                <h3 class="card-title"><i class="fas fa-exclamation-triangle mr-2"></i>Información Médica</h3>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <strong class="text-warning"><i class="fas fa-allergies mr-2"></i>Alergias</strong>
                                    <p class="text-muted small mt-1" th:text="${paciente.alergias ?: 'No registradas'}"></p>
                                </div>
                                <div>
                                    <strong class="text-danger"><i class="fas fa-file-medical mr-2"></i>Antecedentes Médicos</strong>
                                    <p class="text-muted small mt-1" th:text="${paciente.antecedentesMedicos ?: 'No registrados'}"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs de Historial -->
                    <div class="col-md-9">
                        <div class="card card-primary card-outline card-outline-tabs">
                            <div class="card-header p-0 border-bottom-0">
                                <ul class="nav nav-tabs" id="custom-tabs" role="tablist">
                                    <li class="nav-item">
                                        <a class="nav-link active" id="tratamientos-tab" data-toggle="pill" href="#tratamientos" role="tab" aria-controls="tratamientos" aria-selected="true">
                                            <i class="fas fa-procedures mr-2"></i>Tratamientos
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="citas-tab" data-toggle="pill" href="#citas" role="tab" aria-controls="citas" aria-selected="false">
                                            <i class="fas fa-calendar-alt mr-2"></i>Citas
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="odontograma-tab" data-toggle="pill" href="#odontograma" role="tab" aria-controls="odontograma" aria-selected="false">
                                            <i class="fas fa-tooth mr-2"></i>Odontograma
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a class="nav-link" id="comprobantes-tab" data-toggle="pill" href="#comprobantes" role="tab" aria-controls="comprobantes" aria-selected="false">
                                            <i class="fas fa-file-invoice-dollar mr-2"></i>Pagos
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <div class="card-body">
                                <div class="tab-content" id="custom-tabs-content">
                                    <!-- Tab Tratamientos -->
                                    <div class="tab-pane fade show active" id="tratamientos" role="tabpanel" aria-labelledby="tratamientos-tab">
                                        <div class="alert alert-info">
                                            <h5><i class="icon fas fa-info-circle"></i> Tratamientos Realizados</h5>
                                            Aquí se mostrarán todos los tratamientos odontológicos realizados al paciente.
                                            Esta funcionalidad será completada en futuras actualizaciones.
                                        </div>
                                        <!-- Placeholder para futura implementación -->
                                        <div class="text-center text-muted p-5">
                                            <i class="fas fa-procedures" style="font-size: 4rem; opacity: 0.3;"></i>
                                            <p class="mt-3">No hay tratamientos registrados</p>
                                        </div>
                                    </div>

                                    <!-- Tab Citas -->
                                    <div class="tab-pane fade" id="citas" role="tabpanel" aria-labelledby="citas-tab">
                                        <div class="alert alert-info">
                                            <h5><i class="icon fas fa-info-circle"></i> Historial de Citas</h5>
                                            Aquí se mostrará el historial completo de citas (pasadas, presentes y futuras).
                                            Esta funcionalidad será completada en futuras actualizaciones.
                                        </div>
                                        <!-- Placeholder para futura implementación -->
                                        <div class="text-center text-muted p-5">
                                            <i class="fas fa-calendar-alt" style="font-size: 4rem; opacity: 0.3;"></i>
                                            <p class="mt-3">No hay citas registradas</p>
                                        </div>
                                    </div>

                                    <!-- Tab Odontograma -->
                                    <div class="tab-pane fade" id="odontograma" role="tabpanel" aria-labelledby="odontograma-tab">
                                        <div class="alert alert-info">
                                            <h5><i class="icon fas fa-info-circle"></i> Carta Dental (Odontograma)</h5>
                                            Aquí se mostrará el odontograma completo del paciente con el estado de cada pieza dental.
                                            Esta funcionalidad será completada en futuras actualizaciones.
                                        </div>
                                        <!-- Placeholder para futura implementación -->
                                        <div class="text-center text-muted p-5">
                                            <i class="fas fa-tooth" style="font-size: 4rem; opacity: 0.3;"></i>
                                            <p class="mt-3">Odontograma no disponible</p>
                                        </div>
                                    </div>

                                    <!-- Tab Comprobantes -->
                                    <div class="tab-pane fade" id="comprobantes" role="tabpanel" aria-labelledby="comprobantes-tab">
                                        <div class="alert alert-info">
                                            <h5><i class="icon fas fa-info-circle"></i> Historial de Pagos</h5>
                                            Aquí se mostrará el historial de comprobantes y pagos del paciente.
                                            Esta funcionalidad será completada en futuras actualizaciones.
                                        </div>
                                        <!-- Placeholder para futura implementación -->
                                        <div class="text-center text-muted p-5">
                                            <i class="fas fa-file-invoice-dollar" style="font-size: 4rem; opacity: 0.3;"></i>
                                            <p class="mt-3">No hay comprobantes registrados</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>

</html>
